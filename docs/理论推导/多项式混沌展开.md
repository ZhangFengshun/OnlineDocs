---
sort: 3
---
# 广义多项式混沌展开简介

## 1 利用多项式混沌展开获得替代模型
在实际问题中，我们关注的物理量 $$Q$$ 会受到许多经验参数 $$(p_1,p_2,…,p_n)$$ 的影响。这些参数往往是不准确的，并且我们不知道哪一个参数的不确定性对关注量的影响最大。为了量化不确定性参数对关注量的影响，我们需要建立起关注量与参数之间的关系式(替代模型)。建立这种关系式的方法有很多，本文主要介绍多项式混沌展开方法。

### 1.1多项式混沌展开

多项式混沌展开的核心思想是采用正交多项式将关注量 $$Q$$ 展开成不确定性参数 $$p_1,p_2,…,p_n$$ 的函数形式:

$$
Q(p_1,p_2,…,p_n)=\sum_{\alpha_1+\alpha_2+⋯+\alpha_n≤m} C_{\alpha_1,\alpha_2,…,\alpha_n} \prod_{k=1}^n \phi_{\alpha_k}(p_k),
$$

其中, n是不确定性参数的个数, m是展开式的阶数, $$\phi_{α_k}$$ 为带权正交的多项式, $$C_{α_1,α_2,…,α_n}$$ 为展开系数, $$α_k$$ 为正整数表示正交多项式的阶数。一般来说，均匀分布的参数采用勒让德多项式，高斯分布的参数采用埃尔米特多项式。通过上述展开式，我们可以知道关注量随参数的变化趋势，也即得到关注量与参数间的替代模型。

### 1.2展开系数的求解

利用正交多项式的定义，也即： $$\int_{Ω_k} \phi_{α_k} \phi_{β_k} ρ_k dp_k = δ_{α_k β_k} $$ ( $$ρ_k$$ 为权函数)，我们可以得到展开系数的表达式如下：

$$
C_{α_1,α_2,…,α_n} = \int_{Ω_1}…\int_{Ω_n}Q(p_1,…,p_n )\prod_{k=1}^n ρ_k \phi_{α_k} dp_k.
$$

多项式混沌展开的关键就在于求解上述积分。当参数个数比较少时，我们可以直接利用数值方法求解上述多重积分。为了能用更少的点得到比较准确的积分值，我们可以采用高斯公式得到上述多重积分。当不确定性参数比较多(n>5)时,我们可以采用稀疏网格进行求解。

## 2 根据多项式混沌展开求Sobol指数

Sobol指数常用来描述参数的不确定性对关注量的影响。某一参数的Sobol指数越大表示该参数的不确定性对结果的影响越大。参数 $$p_i$$ 全局Sobol指数的定义：

$$
S_{p_i} = 1-\frac{Var(E(Q│p_{\sim i}))}{Var(Q)},
$$

p_(~i)表示不包含参数p_i的参数列表，例如：p_(~i)={…,p_(i-1),p_(i+1),…}。得到多项式混沌展开式以后，我们可以直接根据展开式的系数获得Sobol指数[1]，也即是：
S_(p_i )=(∑_(α_i≠0)▒C_(α_1,α_2,…,α_n)^2 )/(∑_(α_1+α_2+⋯+α_n≤m)▒C_(α_1,α_2,…,α_n)^2 ) 

## 3 例子：Rosenbrock函数

Q(p_1,p_2 )=(1-p_1 )^2+100(p_2-p_1^2 )^2
我们不妨假设不确定性参数p_1~U(a,b)，参数p_2~U(c,d)为均匀分布。要研究这两个参数对关注量Q的影响，我们需要回答两个问题：Q随参数怎样变化？哪一个参数的不确定性对Q的影响最大？
下面我们利用多项式混沌展开得到Q随参数变化的替代模型，而后获得各个参数的Sobol指数。具体过程如下：

### 3.1 参数标准化

将均匀分布的参数映射到-1,1之间(勒让德多项式的正交性)。如果是正太分布的参数则需要映射到标准正太分布(埃尔米特多项式的正交性)。
p_1^*=2 (p_1-a)/(b-a)-1,p_2^*=2 (p_1-c)/(d-c)-1

### 3.2 多项式混沌展开

Q(p_1^*,p_2^*)=∑_(α_1+α_2≤m)▒〖C_(α_1,α_2 ) ϕ_(α_1 ) (p_1^*)ϕ_(α_2 ) (p_2^*)〗
其中，ϕ_(α_1 ) (p_1 ),ϕ_(α_2 ) (p_2)是勒让德多项式。利用正交性可知(见附录)展开系数为：
C_(α_1,α_2 )=∫_(-1)^1▒∫_(-1)^1▒〖Q(p_1^*,p_2^* ) ϕ_(α_1 ) (p_1^* ) ϕ_(α_2 ) (p_2^* )dp_1^* dp_2^* 〗  
利用高斯-勒让德积分公式(见附录)可以将上式子写为：
C_(α_1,α_2 )=∑_(i=1)^l▒∑_(j=1)^l▒〖w_i w_j f(p_(1,i)^*,p_(2,j)^* ) 〗
f(p_(1,i)^*,p_(2,j)^* )=Q(p_(1,i)^*,p_(2,j)^* ) ϕ_(α_1 ) (p_(1,i)^* ) ϕ_(α_2 ) (p_(2,j)^* )
其中，p_(1,i)^*,p_(2,j)^*为l阶勒让德多项式的零点，w_i,w_j为相应的权重系数，可以通过查表得到。下图是l=5(各参数取5个高斯积分点)的情形。
参数p_1的Sobol指数:
S_(p_1 )=(∑_(α_1≠0)▒C_(α_1,α_2)^2 )/(∑_(α_1+α_2≤m)▒C_(α_1,α_2)^2 )
参数p_2的Sobol指数:
S_(p_2 )=(∑_(α_2≠0)▒C_(α_1,α_2)^2 )/(∑_(α_1+α_2≤m)▒C_(α_1,α_2)^2 )

## A 附录

### A.1勒让德多项式：

∫_(-1)^1▒〖P_n (x) P_m (x)dx〗=2/(2n+1) δ_mn
P_(n+1)=(2n+1)/(n+1) xP_n (x)-n/(n+1) P_(n-1) (x),P_0=1,P_1=x
归一化后的勒让德多项式：ϕ_(α_1 ) (x)=√((2α_1+1)/2) P_(α_1 ) (x)

### A.2高斯-勒让德积分公式：

∫_(-1)^1▒〖f(x)dx〗=∑_(i=0)^n▒〖w_i f(x_i ) 〗
其中，x_i为n阶勒让德多项式P_n的零点，w_i为权重系数定义如下：
w_i=2/((1-x_i^2 ) [P_n^' (x_i )]^2 )

## 参考文献
[1] Sudret B. Global sensitivity analysis using polynomial chaos expansions[J]. Reliability engineering & system safety, 2008, 93(7): 964-979.
